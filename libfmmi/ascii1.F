      subroutine ascii1(ntext,text,nchar)
c
c  NAME:
c     ascii1
c
c  PURPOSE:
c     Conversion of characters in a text string from standard ascii
c     to a PC ascii taking care of Norwegian letters.
c
c  SYNOPSIS:
c     subroutine ascii1(ntext,text,nchar)
c     integer       ntext,nchar
c     character*(*) text(ntext)
c
c  INPUT:
c     ntext  - no. of text strings
c     nchar  - no. of characters in each text string
c	       (-1 = all characters in each string)
c
c  INPUT/OUTPUT:
c     text   - the text strings
c
c  NOTES:
c     Norwegian letters on ibm mainframe:   {    º    }    #    @    $
c     Ascii after ascii ftp to unix:       123  186  125   35   64   36
c     Ascii on pc:                         145  155  134  146  157  143
c
c-----------------------------------------------------------------------
c  DNMI/FoU  xx.xx.198x  Anstein Foss
c  DNMI/FoU  06.04.1995  Anstein Foss ... new library version
c-----------------------------------------------------------------------
c
      implicit none
c
      integer       ntext,nchar
      character*(*) text(ntext)
c
      integer nch,n,k,i
      integer a2a(0:255)
c
      data (a2a(i),i=000,009)/000,001,002,003,004,005,006,007,008,009/
      data (a2a(i),i=010,019)/010,011,012,013,014,015,016,017,018,019/
      data (a2a(i),i=020,029)/020,021,022,023,024,025,026,027,028,029/
c.... data (a2a(i),i=030,039)/030,031,032,033,034,035,036,037,038,039/
      data (a2a(i),i=030,039)/030,031,032,033,034,146,143,037,038,039/
c.................................................===.===.............
      data (a2a(i),i=040,049)/040,041,042,043,044,045,046,047,048,049/
      data (a2a(i),i=050,059)/050,051,052,053,054,055,056,057,058,059/
c.... data (a2a(i),i=060,069)/060,061,062,063,064,065,066,067,068,069/
      data (a2a(i),i=060,069)/060,061,062,063,157,065,066,067,068,069/
c.............................................===.....................
      data (a2a(i),i=070,079)/070,071,072,073,074,075,076,077,078,079/
      data (a2a(i),i=080,089)/080,081,082,083,084,085,086,087,088,089/
      data (a2a(i),i=090,099)/090,091,092,093,094,095,096,097,098,099/
      data (a2a(i),i=100,109)/100,101,102,103,104,105,106,107,108,109/
      data (a2a(i),i=110,119)/110,111,112,113,114,115,116,117,118,119/
c.... data (a2a(i),i=120,129)/120,121,122,123,124,125,126,127,128,129/
      data (a2a(i),i=120,129)/120,121,122,145,124,134,126,127,128,129/
c.........................................===.....===.................
      data (a2a(i),i=130,139)/130,131,132,133,134,135,136,137,138,139/
      data (a2a(i),i=140,149)/140,141,142,143,144,145,146,147,148,149/
      data (a2a(i),i=150,159)/150,151,152,153,154,155,156,157,158,159/
      data (a2a(i),i=160,169)/160,161,162,163,164,165,166,167,168,169/
      data (a2a(i),i=170,179)/170,171,172,173,174,175,176,177,178,179/
c.... data (a2a(i),i=180,189)/180,181,182,183,184,185,186,187,188,189/
      data (a2a(i),i=180,189)/180,181,182,183,184,185,155,187,188,189/
c.....................................................===.............
      data (a2a(i),i=190,199)/190,191,192,193,194,195,196,197,198,199/
      data (a2a(i),i=200,209)/200,201,202,203,204,205,206,207,208,209/
      data (a2a(i),i=210,219)/210,211,212,213,214,215,216,217,218,219/
      data (a2a(i),i=220,229)/220,221,222,223,224,225,226,227,228,229/
      data (a2a(i),i=230,239)/230,231,232,233,234,235,236,237,238,239/
      data (a2a(i),i=240,249)/240,241,242,243,244,245,246,247,248,249/
      data (a2a(i),i=250,255)/250,251,252,253,254,255/
c
      nch=nchar
      if(nch.lt.0) nch=len(text(1))
c
      do n=1,ntext
	do k=1,nch
	  text(n)(k:k)=char(a2a(ichar(text(n)(k:k))))
	end do
      end do
c
      return
      end
