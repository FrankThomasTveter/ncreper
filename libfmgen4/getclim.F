      subroutine getclim(TYPE,TIME,LAT,LON,COUT,IRC)
C     ***********************************************************************
C     WRITTEN/MODIFIED BY:                                                  *
C     --------------------------------------------------------------------- *
C     |    NAME      |   DATE   |                 REASON                  | *
C     --------------------------------------------------------------------- *
C     | F. TVETER    | 20/08/02 | NEW                                     | *
C     |              |          |                                         | *
C     --------------------------------------------------------------------- *
C     ***********************************************************************
C
      IMPLICIT NONE
      SAVE
C
C     TYPE=1 : PRESSURE (mb)
C     TYPE=5 : TEMPERATURE (K)
C     TYPE=6 : WATER VAPOUR (Kg/Kg)
C     TYPE=7 : OZONE (Kg/Kg)
C
      INTEGER  NRCLIM
      PARAMETER ( NRCLIM = 50 )
      INTEGER  TYPE,TIME(6),IRC
      REAL   COUT(NRCLIM),LAT,LON
C
      CHARACTER*8 MYNAME
      DATA MYNAME /'GETCLIM'/
C
      REAL   IPRESC(NRCLIM,4),ITEMPC(NRCLIM,4),
     &     IWATVC(NRCLIM,4),IOZONEC(NRCLIM,4)
C
      DATA IPRESC /
C
C     NOTE: SURFACE-PRESSURE HAS BEEN EXTENDED TO 1050 mBar...
C
C     CLIMATOLOGICAL*4 MID LATITUDE WINTER PRESSURE
     &     0.000036,0.0000598,0.0001057,0.0002,0.0004074,
     &     0.000877,0.00198,0.00456,0.0130,0.0222,0.047,
     &     0.095,0.188,0.362,0.683,0.94,1.29,1.8,2.53,
     &     3.6,5.18,7.56,11.1,16.46,24.4,28.6,33.4,39.1,
     &     45.8,53.7,62.8,73.6,86.1,100.7,117.8,137.8,
     &     161.1,188.2,219.9,256.8,299.3,347.3,401.6,
     &     462.7,531.3,608.1,693.8,789.7,897.3,1050.0,
C     CLIMATOLOGICAL*4 MID LATITUDE SUMMER PRESSURE
     &     0.0000227,0.0000356,0.0000611,0.000117,
     &     0.000258,0.000625,0.00164,0.00448,0.012,
     &     0.03,0.067,0.139,0.272,0.515,0.951,1.29,
     &     1.76,2.41,3.33,4.64,6.52,9.3,13.2,19.07,
     &     27.7,32.2,37.6,43.7,51.0,59.5,69.5,81.2,
     &     95.0,111.0,130.,153.0,179.0,209.0,243.0,
     &     281.0,324.0,372.0,426.0,487.0,554.0,628.0,
     &     710.0,802.0,902.0,1050.0,
C     CLIMATOLOGICAL*4 SUB ARCTIC WINTER PRESSURE
     &     0.0000359,0.0000600,0.0000108,0.000207,
     &     0.000423,0.000907,0.002022,0.00450,0.00966,0.02,
     &     0.04,0.079,0.155,0.299,0.5719,0.79,1.113,1.57,
     &     2.243,3.23,4.701,6.91,10.2,15.13,22.56,26.49,31.09,
     &     36.47,42.77,50.14,58.75,68.82,80.58,94.31,110.3,
     &     129.1,151.0,176.6,206.7,241.8,282.9,330.8,385.3,
     &     446.7,515.8,593.2,679.8,777.5,878.8,1050.0,
C     CLIMATOLOGICAL*4 SUB ARCTIC SUMMER PRESSURE
     &     0.0000226,0.0000354,0.00006,0.000113,
     &     0.000248,0.000606,0.00161,0.00451,0.0125,0.032,
     &     0.071,0.147,0.288,0.537,0.987,1.34,1.82,2.48,
     &     3.4,4.72,5.61,9.4,13.4,19.23,27.80,32.28,37.5,
     &     43.6,50.7,59.0,69.6,79.8,92.8,108.0,126.0,146.0,
     &     170.0,197.7,230.0,267.7,310.8,359.0,413.0,474.0,
     &     541.0,616.0,700.0,792.9,896.0,1050.0 /
C
      DATA ITEMPC /
C     CLIMATOLOGICAL*4 MID LATITUDE WINTER TEMPERATURE
     &     333.0,293.0,259.5,237.1,218.6,208.3,199.5,
     &     199.8,210.1,220.4,230.7,240.9,250.8,260.6,
     &     265.7,265.1,258.5,250.8,243.2,235.5,227.9,
     &     220.4,217.4,215.5,215.2,215.2,215.2,215.2,
     &     215.2,215.2,215.2,215.7,216.2,216.7,217.2,
     &     217.7,218.2,218.7,219.2,219.7,225.7,231.7,
     &     237.7,243.7,249.7,255.7,261.7,265.2,268.7,
     &     272.2,
C     CLIMATOLOGICAL*4 MID LATITUDE SUMMER TEMPERATURE
     &     380.0,316.8,262.4,222.2,190.5,178.3,165.0,
     &     165.1,174.1,196.1,218.1,240.1,257.1,269.3,
     &     275.7,275.2,269.9,263.7,257.5,251.3,245.2,
     &     239.0,233.7,228.5,225.1,223.9,222.8,221.6,
     &     220.4,219.2,217.9,216.8,215.7,215.7,215.7,
     &     215.7,215.8,222.3,228.8,235.3,241.7,248.2,
     &     254.7,261.2,267.2,273.2,279.2,285.2,289.7,
     &     294.2,
C     CLIMATOLOGICAL*4 SUB ARCTIC WINTER TEMPERATURES
     &     333.0,288.5,252.6,234.0,218.5,211.0,202.3,
     &     213.1,223.9,234.7,245.4,248.4,250.9,259.9,
     &     259.3,253.2,247.0,240.8,234.7,228.5,222.3,
     &     218.5,216.0,213.6,211.2,211.8,212.4,213.0,
     &     213.6,214.2,214.8,215.4,216.0,216.6,217.2,
     &     217.2,217.2,217.2,217.2,217.2,217.2,220.6,
     &     227.3,234.1,240.9,247.7,252.7,255.9,259.1,
     &     257.2,
C     CLIMATOLOGICAL*4 SUB ARCTIC SUMMER TEMPERATURES
     &     380.0,322.7,270.1,226.0,190.4,176.8,
     &     161.6,161.7,170.6,193.6,216.6,239.7,262.7,
     &     274.0,277.2,276.2,273.6,269.5,262.1,254.6,
     &     247.2,240.0,235.1,231.0,228.1,226.6,225.2,
     &     225.2,225.2,225.2,225.2,225.2,225.2,225.2,
     &     225.2,225.2,225.2,225.2,225.2,225.2,232.2,
     &     239.2,246.1,253.1,260.1,265.5,270.9,276.3,
     &     281.7,287.2 /
C
      DATA IWATVC /
C     CLIMATOLOGICAL*4 MID LATITUDE WINTER WATER VAPOUR PPM
     &     0.2,0.24,0.28,0.34,0.4,0.54,0.85,1.33,2.0,
     &     2.7,3.3,4.0,4.5,4.85,4.95,5.0,5.0,5.0,4.95,
     &     4.90,4.85,4.80,4.75,4.70,4.65,4.60,4.55,4.53,
     &     4.50,4.50,4.50,4.50,4.50,4.60,4.70,4.80,
     &     5.0,6.0,10.0,29.6,55.7,108.0,232.0,510.0,
     &     824.0,1280.0,2090.0,2790.0,3450.0,4320.0,
C     CLIMATOLOGICAL*4 MID LATITUDE SUMMER WATER VAPOUR PPM
     &     0.2,0.24,0.28,0.34,0.4,0.54,0.85,1.33,2.1,
     &     2.95,3.7,4.4,5.0,5.35,5.5,5.5,5.45,5.3,5.1,
     &     5.0,4.95,4.85,4.7,4.45,4.2,4.0,3.85,3.6,3.45,
     &     3.3,3.2,3.15,3.2,3.3,3.4,5.0,8.0,29.4,95.6,
     &     247.0,413.0,646.0,1030.0,1510.0,2230.0,
     &     3810.0,5980.0,9680.0,13800.0,18800.0,
C     CLIMATOLOGICAL*4 SUB ARCTIC WINTER WATER VAPOUR PPM
     &     0.2,0.24,0.28,0.34,0.4,0.54,0.85,1.33,2.0,
     &     2.7,3.3,4.0,4.5,4.85,4.95,5.0,5.0,5.0,5.0,
     &     5.0,5.0,5.0,5.0,5.0,5.0,5.0,4.95,4.9,4.85,
     &     4.80,4.75,4.70,4.65,4.60,4.55,4.50,4.45,6.0,
     &     10.0,20.0,29.8,33.8,147.0,237.0,431.0,790.0,
     &     1170.0,1430.0,1620.0,1410.0,
C     CLIMATOLOGICAL*4 SUB ARCTIC SUMMER WATER VAPOUR PPM
     &     0.2,0.24,0.28,0.34,0.4,0.54,0.85,
     &     1.33,2.0,2.7,3.3,4.0,4.5,4.85,4.95,5.0,5.0,
     &     5.0,5.0,5.0,5.0,5.0,5.0,4.95,4.90,4.85,4.83,
     &     4.80,4.70,4.60,4.50,4.30,4.05,4.0,4.0,4.0,
     &     4.45,6.0,13.3,42.4,130.0,400.0,797.0,1330.0,
     &     2220.0,3380.0,4820.0,6750.0,8700.0,11900.0 /
C
      DATA IOZONEC /
C     CLIMATOLOGICAL*4 MID LATITUDE WINTER OZONE PPM
     &     0.0005,0.005,0.05,0.2,0.4,0.8,0.8,0.55,0.230,
     &     0.250,0.32,0.55,1.0,1.7,2.75,3.7,4.6,5.9,6.9,
     &     7.2,7.1,6.8,6.1,5.6,5.1,4.7,4.3,3.9,3.5,2.9,
     &     2.3,1.8,1.4,1.1,0.9,0.8,0.704,0.523,0.362,
     &     0.237,0.157,0.104,0.0789,0.0584,0.0472,
     &     0.0357,0.0320,0.0285,0.0280,0.0278,
C     CLIMATOLOGICAL*4 MID LATITUDE SUMMER OZONE PPM
     &     0.0005,0.005,0.05,0.2,0.4,0.7,0.75,0.57,0.2,
     &     0.19,0.5,0.8,1.3,1.8,2.8,3.5,4.5,5.9,7.55,8.7,
     &     8.9,8.1,7.0,6.0,4.8,4.0,3.4,2.9,2.4,2.0,1.5,
     &     1.0,0.7,0.5,0.5,0.44,0.3,0.223,0.179,0.130,
     &     0.111,0.0913,0.0776,0.0642,0.0551,0.0482,
     &     0.0422,0.0369,0.0334,0.0302,
C     CLIMATOLOGICAL*4 SUB ARCTIC WINTER OZONE PPM
     &     0.00005,0.005,0.05,0.2,0.4,0.8,0.8,0.75,0.13,
     &     0.33,0.5,0.65,0.95,1.6,2.6,3.0,4.1,5.1,5.9,
     &     6.25,6.2,5.9,5.4,4.9,4.7,4.6,4.5,4.2,4.0,3.7,
     &     3.1,2.45,1.9,1.5,1.2,0.9,0.65,0.4,0.35,0.3,
     &     0.21,0.104,0.0725,0.0445,0.038,0.0325,0.0277,
     &     0.0234,0.0207,0.0180,
C     CLIMATOLOGICAL*4 SUB ARCTIC SUMMER OZONE PPM
     &     0.0005,0.005,0.05,0.2,0.4,0.8,
     &     0.9,0.65,0.18,0.2,0.4,0.8,1.2,1.7,2.5,3.2,
     &     4.2,5.4,7.0,7.8,7.7,6.9,5.7,5.3,4.5,4.2,3.7,
     &     3.3,2.7,2.1,1.7,1.3,1.0,0.85,0.70,0.60,0.50,
     &     0.41,0.305,0.189,0.142,0.0911,0.0774,0.0565,
     &     0.0533,0.0448,0.0389,0.0338,0.0294,0.0241 /
C     
      REAL   FWATV, FOZONE,MAXLAT,MINLAT,
     &     X1,Y1,X5,X6,X7,X8,W
      INTEGER  II
C      
      PARAMETER (FWATV =  1.0D-6 * 18.0153D-3/28.964D-3)
      PARAMETER (FOZONE = 1.0D-6 * 3.0D0 * 16.0153D-3/28.964D-3)
      PARAMETER (MAXLAT = 75.0D0, MINLAT = 50.0D0)
C
C     FIND THE PROFILES FROM WHICH TO INTERPOLATE
C
      Y1 = MIN(MAX((LAT-MINLAT)/(MAXLAT-MINLAT),
     &     0.0D0),1.0D0)
      X1 = MIN(MAX(MOD((3.0D0+DFLOAT(TIME(2)))/12.0D0,
     &     1.0D0),0.0D0),1.0D0)
      X5=1-X1-Y1+X1*Y1
      X6=X1-X1*Y1
      X7=Y1-X1*Y1
      X8=X1*Y1
      
      IF (TYPE.EQ.0) THEN ! get pressure levels
         DO II=1,NRCLIM
            COUT(II) = 
     &           (X5*IPRESC(II,1)+
     &           X6*IPRESC(II,2)+
     &           X7*IPRESC(II,3)+
     &           X8*IPRESC(II,4))
         END DO
      ELSE IF (TYPE.EQ.5) THEN  ! get temperature levels
         DO II=1,NRCLIM
            COUT(II) = 
     &           (X5*ITEMPC(II,1)+
     &           X6*ITEMPC(II,2)+
     &           X7*ITEMPC(II,3)+
     &           X8*ITEMPC(II,4))
         END DO
      ELSE IF (TYPE.EQ.6) THEN  ! get water vapour levels
         DO II=1,NRCLIM
            COUT(II) = 
     &           (X5*IWATVC(II,1)+
     &           X6*IWATVC(II,2)+
     &           X7*IWATVC(II,3)+
     &           X8*IWATVC(II,4))
            W = COUT(II)  * FWATV
            COUT(II) = W/(1.0D0 + W)
         END DO
      ELSE IF (TYPE.EQ.7) THEN  ! get ozone levels
         DO II=1,NRCLIM
            COUT(II) = 
     &           (X5*IOZONEC(II,1)+
     &           X6*IOZONEC(II,2)+
     &           X7*IOZONEC(II,3)+
     &           X8*IOZONEC(II,4))
            W = COUT(II)  * FOZONE
            COUT(II) = W/(1.0D0 + W)
         END DO
      ELSE
         WRITE(*,*) MYNAME,'Invalid type:',TYPE
         IRC=444
         RETURN
      END IF
      RETURN
      END
